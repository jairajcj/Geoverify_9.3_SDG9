<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GeoVerify | AI-Blockchain Sentinel</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600&family=Space+Mono:wght@400;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="stylesheet" href="/static/css/marketplace.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <div class="app-container">
        <!-- Sidebar -->
        <nav class="sidebar">
            <div class="logo">
                <span class="icon">üåç</span> GeoVerify
            </div>
            <ul class="nav-links">
                <li data-view="dashboard" class="active">Dashboard</li>
                <li data-view="audit">Audit Log</li>
                <li data-view="sentinel">Sentinel Config</li>
                <li data-view="marketplace">Marketplace</li>
                <li data-view="settings">Settings</li>
            </ul>
            <div class="status-panel">
                <div class="status-item">
                    <span class="label">System Status</span>
                    <span class="value online">ONLINE</span>
                </div>
                <div class="status-item">
                    <span class="label">Nodes Active</span>
                    <span class="value">128</span>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <header class="top-bar">
                <h1 id="pageTitle">Sentinel Dashboard</h1>
                <div class="user-profile">
                    <span>Admin</span>
                    <div class="avatar"></div>
                </div>
            </header>

            <section id="dashboardView" class="view">
                <section class="dashboard-grid">
                    <!-- Map / Input Section -->
                    <div class="card map-card">
                        <div class="card-header">
                            <h2>New Asset Verification</h2>
                            <span class="badge live">LIVE FEED</span>
                        </div>
                        <div class="map-interface">
                            <div class="coordinates-input">
                                <input type="text" id="latInput" placeholder="Latitude (e.g., -3.4653)" value="-3.4653">
                                <input type="text" id="lonInput" placeholder="Longitude (e.g., 62.2159)"
                                    value="62.2159">
                                <button id="verifyBtn" class="btn-primary">
                                    <span class="btn-text">Verify & Mine</span>
                                    <div class="loader hidden"></div>
                                </button>
                                <button id="estimateBtn" class="btn-secondary">
                                    <span class="btn-text">Estimate Credits</span>
                                </button>

                            </div>
                            <div class="visualizer" id="visualizer">
                                <div class="scanning-overlay hidden"></div>
                                <div class="placeholder-text">Satellite Uplink Ready...</div>
                            </div>
                        </div>
                    </div>

                    <!-- Live Results -->
                    <div class="card result-card">
                        <div class="card-header">
                            <h2>Analysis Result</h2>
                        </div>
                        <div class="metrics-grid" id="resultsContainer">
                            <div class="metric">
                                <span class="label">Asset Status</span>
                                <span class="value" id="statusValue">--</span>
                            </div>
                            <div class="metric">
                                <span class="label">Green Cover</span>
                                <span class="value" id="coverValue">--%</span>
                            </div>
                            <div class="metric">
                                <span class="label">AI Confidence</span>
                                <span class="value" id="confidenceValue">--%</span>
                            </div>
                            <div class="metric highlight">
                                <span class="label">Carbon Credits</span>
                                <span class="value" id="creditsValue">-- tCO2e</span>
                            </div>
                            <div class="metric full-width"
                                style="grid-column: 1 / -1; margin-top: 1rem; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 0.5rem;">
                                <span class="label">Sentinel Report</span>
                                <span class="value" id="reasonValue"
                                    style="font-size: 0.9rem; font-weight: normal; color: #aaa;">Waiting for
                                    scan...</span>
                            </div>
                        </div>
                    </div>

                    <!-- Blockchain Feed -->
                    <div class="card wide-card">
                        <div class="card-header">
                            <h2>Immutable Ledger Stream</h2>
                            <button id="refreshChain" class="btn-icon">‚Üª</button>
                        </div>
                        <div class="ledger-feed" id="ledgerFeed">
                            <!-- Blocks will be injected here -->
                            <div class="ledger-item empty-state">Waiting for new blocks...</div>
                        </div>
                    </div>
                </section>
            </section>

            <!-- Marketplace View (Hidden by default) -->
            <section id="marketplaceView" class="view hidden">
                <!-- Market Intelligence Ticker -->
                <div class="market-ticker">
                    <div class="ticker-content">
                        <span class="ticker-label">LIVE MARKET INDEX:</span>
                        <span class="ticker-value" id="liveMarketPrice">$0.00</span>
                        <span class="ticker-change" id="marketPriceChange">+0.00%</span>
                        <span class="ticker-divider">|</span>
                        <span class="ticker-item">EU ETS: <span class="v">$84.20</span></span>
                        <span class="ticker-item">US RGGI: <span class="v">$15.45</span></span>
                        <span class="ticker-item">CNW: <span class="v">$9.12</span></span>
                    </div>
                </div>

                <!-- Market Overview Stats -->
                <section class="market-stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">üí∞</div>
                        <div class="stat-content">
                            <span class="stat-label">Total Volume</span>
                            <span class="stat-value" id="totalVolume">$0</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üìú</div>
                        <div class="stat-content">
                            <span class="stat-label">Active Listings</span>
                            <span class="stat-value" id="activeListings">0</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">ü§ù</div>
                        <div class="stat-content">
                            <span class="stat-label">Total Trades</span>
                            <span class="stat-value" id="totalTrades">0</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üìâ</div>
                        <div class="stat-content">
                            <span class="stat-label">Avg Price</span>
                            <span class="stat-value" id="avgPrice">$0.00</span>
                        </div>
                    </div>
                    <div class="stat-card" id="activeTradersCard" style="cursor: pointer;">
                        <div class="stat-icon">üè¢</div>
                        <div class="stat-content">
                            <span class="stat-label">Active Traders</span>
                            <span class="stat-value" id="activeTraders">0</span>
                        </div>
                    </div>
                </section>

                <!-- Action Bar -->
                <section class="action-bar">
                    <button id="registerCompanyBtn" class="btn-primary">Register Company</button>
                    <button id="sellCreditsBtn" class="btn-secondary">Sell Carbon Credits</button>
                    <button id="predictFootprintBtn" class="btn-accent">AI Footprint Predictor</button>
                    <button id="buyCreditsBtn" class="btn-primary">Fast Match (Buy)</button>
                </section>

                <!-- Market Analytics Section -->
                <section class="marketplace-section analytics-section">
                    <div class="section-header">
                        <h2>Market Analytics & Trends</h2>
                    </div>
                    <div class="analytics-grid">
                        <div class="chart-container">
                            <h3>Price History (14 Days)</h3>
                            <canvas id="priceChart"></canvas>
                        </div>
                        <div class="trending-regions">
                            <h3>Trending Verified Regions</h3>
                            <div id="trendingList">
                                <div class="trend-item">
                                    <span class="region">Amazon Basin</span>
                                    <span class="t-badge up">+12.4%</span>
                                </div>
                                <div class="trend-item">
                                    <span class="region">SE Asia Reforestation</span>
                                    <span class="t-badge up">+8.1%</span>
                                </div>
                                <div class="trend-item">
                                    <span class="region">Nordic Green Tech</span>
                                    <span class="t-badge down">-2.4%</span>
                                </div>
                            </div>
                        </div>
                        <div class="market-news-card">
                            <h3>Network Intelligence News</h3>
                            <div class="news-list">
                                <div class="news-item">
                                    <span class="news-tag">B2B</span>
                                    <p>Global manufacturing demand for forest-based credits rises by 15% this quarter.
                                    </p>
                                </div>
                                <div class="news-item">
                                    <span class="news-tag highlight">TECH</span>
                                    <p>GeoVerify Nodes upgrade to Sentinel v2.5 with improved ZK-Geospatial protocols.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Marketplace Listings -->
                <section class="marketplace-section">
                    <div class="section-header">
                        <h2>Verified Credit Listings</h2>
                        <div class="filter-controls">
                            <input type="number" id="maxPriceFilter" placeholder="Max Price ($)" class="filter-input">
                            <input type="number" id="minAmountFilter" placeholder="Min Credits" class="filter-input">
                            <button id="applyFiltersBtn" class="btn-icon">üîç</button>
                            <button id="refreshListingsBtn" class="btn-icon">‚Üª</button>
                        </div>
                    </div>
                    <div class="listings-grid" id="listingsGrid">
                        <div class="loading-spinner">Loading available credits...</div>
                    </div>
                </section>

                <!-- Recent Transactions -->
                <section class="transactions-section">
                    <div class="section-header">
                        <h2>Recent Network Transactions</h2>
                        <button id="refreshTransactionsBtn" class="btn-icon">‚Üª</button>
                    </div>
                    <div class="transactions-list" id="transactionsList">
                        <div class="loading-spinner">Fetching ledger history...</div>
                    </div>
                </section>
            </section>

            <!-- Settings View (Hidden by default) -->
            <section id="settingsView" class="view hidden">
                <div class="settings-container">
                    <div class="settings-sidebar">
                        <ul class="settings-tabs">
                            <li class="active" data-tab="general">General</li>
                            <li data-tab="security">Security & Node</li>
                            <li data-tab="notifications">Notifications</li>
                            <li data-tab="api">API Keys</li>
                        </ul>
                    </div>

                    <div class="settings-main">
                        <!-- General Settings -->
                        <div id="settings-general" class="settings-tab-content">
                            <div class="settings-header">
                                <h2>General Preferences</h2>
                            </div>
                            <div class="settings-group">
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <label>Auto-Refresh Interval</label>
                                        <p>Adjust how often the dashboard data refreshes (seconds)</p>
                                    </div>
                                    <input type="number" id="settingRefresh" value="30" class="setting-input-small">
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <label>Visualizer Animations</label>
                                        <p>Enable high-tech scanning overlays</p>
                                    </div>
                                    <label class="switch">
                                        <input type="checkbox" checked id="settingAnimToggle">
                                        <span class="slider"></span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Security & Node Settings -->
                        <div id="settings-security" class="settings-tab-content hidden">
                            <div class="settings-header">
                                <h2>Security & Node Configuration</h2>
                            </div>
                            <div class="settings-group">
                                <div class="form-group">
                                    <label>Blockchain Provider URL</label>
                                    <input type="text" value="https://polygon-mainnet.infura.io/v3/..."
                                        class="form-input">
                                </div>
                                <div class="form-group">
                                    <label>Sentinel Node Private Key</label>
                                    <input type="password" value="********************************" class="form-input">
                                    <small>Keys are encrypted at rest using AES-256 (Simulated)</small>
                                </div>
                            </div>
                        </div>

                        <!-- Notification Settings -->
                        <div id="settings-notifications" class="settings-tab-content hidden">
                            <div class="settings-header">
                                <h2>Notification Preferences</h2>
                            </div>
                            <div class="settings-group">
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <label>Email Alerts</label>
                                        <p>Receive email when an inquiry is received</p>
                                    </div>
                                    <label class="switch">
                                        <input type="checkbox" checked id="toggleEmailAlerts">
                                        <span class="slider"></span>
                                    </label>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <label>Critical Failures</label>
                                        <p>Alert on sentinel node disconnection</p>
                                    </div>
                                    <label class="switch">
                                        <input type="checkbox" checked>
                                        <span class="slider"></span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- API Settings -->
                        <div id="settings-api" class="settings-tab-content hidden">
                            <div class="settings-header">
                                <h2>API Management</h2>
                            </div>
                            <div class="settings-group">
                                <div class="form-group">
                                    <label>Satellite Data Provider API Key</label>
                                    <div class="api-key-box">
                                        <input type="text" placeholder="Enter API Key" class="form-input"
                                            style="flex: 1;">
                                        <button class="btn-primary" style="white-space: nowrap;">Connect
                                            Provider</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="settings-footer">
                            <button class="btn-secondary" onclick="alert('Settings reset to default values.')">Reset to
                                Default</button>
                            <button class="btn-primary" id="saveSettingsBtn">Save Changes</button>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Audit Log Modal -->
    <div id="auditLogModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üîç Blockchain Audit Log</h2>
                <button class="close-modal" data-modal="auditLogModal">&times;</button>
            </div>
            <div class="modal-body">
                <div id="auditLogContent" class="log-container">
                    <div class="loading-spinner">Loading audit data...</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Sentinel Log Modal -->
    <div id="sentinelLogModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üõ∞Ô∏è Sentinel Activity Log</h2>
                <button class="close-modal" data-modal="sentinelLogModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="sentinel-stats" id="sentinelStats"></div>
                <div id="sentinelLogContent" class="log-container">
                    <div class="loading-spinner">Loading sentinel data...</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Active Traders Modal -->
    <div id="tradersModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üè¢ Active Network Enterprises</h2>
                <button class="close-modal" data-modal="tradersModal">&times;</button>
            </div>
            <div class="modal-body">
                <div id="tradersList" class="traders-grid">
                    <div class="loading-spinner">Fetching active enterprises...</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Register Company Modal -->
    <div id="registerModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üè¢ Register Your Enterprise</h2>
                <button class="close-modal" data-modal="registerModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="registerForm" class="marketplace-form">
                    <div class="form-group">
                        <label for="companyName">Company Name</label>
                        <input type="text" id="companyName" required placeholder="e.g. GreenTech Industries">
                    </div>
                    <div class="form-group">
                        <label for="industry">Industry Sector</label>
                        <select id="industry" required>
                            <option value="">Select Sector</option>
                            <option value="Manufacturing">Manufacturing</option>
                            <option value="Energy">Energy</option>
                            <option value="Agriculture">Agriculture</option>
                            <option value="Forestry">Forestry</option>
                            <option value="Technology">Technology</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="country">Country</label>
                        <input type="text" id="country" required placeholder="e.g. Germany">
                    </div>
                    <div class="form-group">
                        <label for="companyEmail">Contact Email</label>
                        <input type="email" id="companyEmail" required placeholder="e.g. contact@greentech.io">
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn-primary">Complete Registration</button>
                    </div>
                    <div id="registrationResult" class="result-message hidden"></div>
                </form>
            </div>
        </div>
    </div>

    <!-- Sell Credits Modal -->
    <div id="sellModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üåø List Carbon Credits</h2>
                <button class="close-modal" data-modal="sellModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="sellForm" class="marketplace-form">
                    <div class="form-group">
                        <label for="sellerCompanyId">Company ID</label>
                        <input type="text" id="sellerCompanyId" required placeholder="Enter your registered ID">
                    </div>
                    <div class="form-group">
                        <label for="creditAmount">Credit Amount (tCO2e)</label>
                        <input type="number" id="creditAmount" step="0.01" required placeholder="e.g. 150.50">
                    </div>
                    <div class="form-group">
                        <label for="pricePerCredit">Price per Credit ($)</label>
                        <input type="number" id="pricePerCredit" step="0.01" required placeholder="e.g. 25.00">
                    </div>
                    <div class="form-group">
                        <label for="creditLocation">Project Location</label>
                        <input type="text" id="creditLocation" placeholder="e.g. Amazon Rainforest, Brazil">
                    </div>
                    <div class="form-group">
                        <label for="creditDescription">Description</label>
                        <textarea id="creditDescription" rows="3"
                            placeholder="Describe the verification source..."></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn-primary">Create Listing</button>
                    </div>
                    <div id="sellResult" class="result-message hidden"></div>
                </form>
            </div>
        </div>
    </div>

    <!-- Buy Credits Modal (Manual Order) -->
    <div id="buyModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üõí Create Purchase Order</h2>
                <button class="close-modal" data-modal="buyModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="buyForm" class="marketplace-form">
                    <div class="form-group">
                        <label for="buyerCompanyId">Company ID</label>
                        <input type="text" id="buyerCompanyId" required placeholder="Enter your registered ID">
                    </div>
                    <div class="form-group">
                        <label for="buyAmount">Desired Amount (tCO2e)</label>
                        <input type="number" id="buyAmount" step="0.01" required placeholder="e.g. 100.00">
                    </div>
                    <div class="form-group">
                        <label for="maxPrice">Maximum Price ($/credit)</label>
                        <input type="number" id="maxPrice" step="0.01" required placeholder="e.g. 30.00">
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn-primary">Place Buy Order</button>
                    </div>
                    <div id="buyResult" class="result-message hidden"></div>
                </form>
            </div>
        </div>
    </div>

    <!-- Carbon Footprint Predictor Modal -->
    <div id="footprintModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ü§ñ AI Carbon Footprint Predictor</h2>
                <button class="close-modal" data-modal="footprintModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="footprintForm" class="marketplace-form">
                    <div class="form-group">
                        <label for="monthlyOutput">Monthly Production Output (Units)</label>
                        <input type="number" id="monthlyOutput" required placeholder="e.g. 5000">
                    </div>
                    <div class="form-group">
                        <label for="energySource">Primary Energy Source</label>
                        <select id="energySource" required>
                            <option value="grid">Main Electricity Grid</option>
                            <option value="coal">Coal Powered</option>
                            <option value="natural_gas">Natural Gas</option>
                            <option value="renewable">Solar/Wind (Renewable)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="rawMaterial">Raw Material Consumption (Tons)</label>
                        <input type="number" id="rawMaterial" required placeholder="e.g. 200">
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn-primary">Calculate Path to Net-Zero</button>
                    </div>
                </form>
                <div id="footprintResult" class="footprint-result-box hidden">
                    <div class="res-item">
                        <span class="l">Estimated Monthly Footprint:</span>
                        <span class="v" id="estEmissions">0 tCO2e</span>
                    </div>
                    <div class="res-item highlight">
                        <span class="l">Recommended Offset Credits:</span>
                        <span class="v" id="recCredits">0 tCO2e</span>
                    </div>
                    <p id="netZeroPath" style="font-size: 0.9rem; color: var(--accent); margin-top: 1rem;"></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Detailed Company Profile Modal -->
    <div id="companyProfileModal" class="modal hidden">
        <div class="modal-content profile-modal">
            <div class="modal-header">
                <h2 id="profileCompanyName">üè¢ Enterprise Profile</h2>
                <button class="close-modal" data-modal="companyProfileModal">&times;</button>
            </div>
            <div class="modal-body" id="profileModalBody">
                <div class="profile-header">
                    <div class="profile-main-stats">
                        <div class="p-stat">
                            <span class="l">Industry</span>
                            <span class="v" id="profileIndustry">--</span>
                        </div>
                        <div class="p-stat">
                            <span class="l">Country</span>
                            <span class="v" id="profileCountry">--</span>
                        </div>
                        <div class="p-stat">
                            <span class="l">Reputation</span>
                            <span class="v highlight" id="profileReputation">100/100</span>
                        </div>
                    </div>
                </div>
                <div class="profile-grid">
                    <div class="profile-section">
                        <h3>Trading History</h3>
                        <div id="profileTransactions" class="mini-log"></div>
                    </div>
                    <div class="profile-section">
                        <h3>Active Listings</h3>
                        <div id="profileListings" class="mini-log"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Verification Certificate Modal -->
    <div id="certificateModal" class="modal hidden">
        <div class="modal-content certificate-content">
            <div class="modal-header no-border">
                <button class="close-modal" data-modal="certificateModal">&times;</button>
            </div>
            <div class="certificate-frame">
                <div class="cert-header">
                    <div class="cert-logo">üåç GEOVERIFY</div>
                    <div class="cert-title">DIGITAL CARBON CREDIT CERTIFICATE</div>
                </div>
                <div class="cert-body">
                    <p class="cert-intro">This certifies that the following geospatial asset has been verified by the
                        GeoVerify AI Sentinel System and recorded on the immutable ledger.</p>

                    <div class="cert-main-data">
                        <div class="cert-row">
                            <span class="cert-label">ASSET LOCATION:</span>
                            <span class="cert-value" id="certLocation">--</span>
                        </div>
                        <div class="cert-row">
                            <span class="cert-label">GREEN COVER:</span>
                            <span class="cert-value" id="certCover">--</span>
                        </div>
                        <div class="cert-row">
                            <span class="cert-label">CARBON CREDITS:</span>
                            <span class="cert-value" id="certCredits">-- tCO2e</span>
                        </div>
                        <div class="cert-row">
                            <span class="cert-label">BLOCK HASH:</span>
                            <span class="cert-value mono" id="certHash">--</span>
                        </div>
                    </div>

                    <div class="cert-footer">
                        <div class="cert-seal">
                            <div class="seal-inner">VERIFIED</div>
                        </div>
                        <div class="cert-meta">
                            <p>DATE: <span id="certDate">--</span></p>
                            <p>ID: <span id="certId">--</span></p>
                            <div class="qr-placeholder"
                                style="width: 60px; height: 60px; background: white; padding: 2px;">
                                <div
                                    style="width: 100%; height: 100%; border: 2px solid black; display: flex; align-items: center; justify-content: center; font-size: 0.4rem; color: black; font-weight: bold; text-align: center;">
                                    BLOCKCHAIN<br>VERIFIED</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-actions" style="margin-top: 1rem; display: flex; justify-content: center;">
                <button class="btn-primary" onclick="window.print()">Download Certificate</button>
            </div>
        </div>
    </div>

    <script src="/static/js/main.js"></script>
    <script src="/static/js/marketplace.js"></script>
</body>

</html>